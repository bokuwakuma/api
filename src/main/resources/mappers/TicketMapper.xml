<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="jp.alhinc.orchestra.ticket.mapper.TicketMapper">

    <resultMap id="ticketResultMap" type="Ticket">
        <id property="id" column="id" />
        <result property="title" column="title" />
        <result property="text" column="text" />
        <result property="finished" column="finished" />
        <result property="createdAt" column="created_at" />
    </resultMap>

    <select id="findById" resultType="Ticket" resultMap="ticketResultMap">
    <![CDATA[
    select
      id, title, text, finished, created_at
    from
      ticket
    where
      id = #{id}
    ]]>
    </select>

    <select id="findAll" resultType="Ticket" resultMap="ticketResultMap">
    <![CDATA[
    SELECT
        id, title, text, finished, created_at
    FROM
        ticket
    ]]>
    </select>
    <insert id="create">
    <![CDATA[
    INSERT INTO ticket (
        id,
        title,
        text,
        finished,
        created_at
    ) VALUES (
        #{id},
        #{title},
        #{text},
        #{finished},
        #{createdAt}
    )
    ]]>
    </insert>

    <update id="updateById" parameterType="Ticket">
    <![CDATA[
        UPDATE ticket
        SET
            title = #{title},
            text = #{text},
            finished = #{finished},
            created_at = #{createdAt}
        WHERE
            id = #{id}
    ]]>
    </update>
    <delete id="deleteById" parameterType="Ticket">
    <![CDATA[
        DELETE FROM
            ticket
        WHERE
            id = #{id}
    ]]>
    </delete>
    <select id="countByFinished" parameterType="Boolean"
            resultType="Long">
    <![CDATA[
        SELECT
            COUNT(*)
        FROM
            ticket
        WHERE
            finished = #{finished}
    ]]>
    </select>
</mapper>